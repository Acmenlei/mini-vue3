let u=[],a=null;class p{constructor(t){this._fn=t,this.run()}run(){try{return a=this,u.push(this),this._fn()}finally{u.pop(),a=u[u.length-1]}}}const c=new WeakMap;function h(e,t){c.has(e)||c.set(e,new WeakMap);let n=c.get(e);n.has(t)||n.set(t,new Set),n.get(t).add(a)}function d(e,t){let n=c.get(e);if(!n)return;let r=n.get(t);!r||r.forEach(s=>{s.run()})}function w(e){new p(e)}function M(e){return typeof e=="object"&&e!=null}function E(e,t){return isNaN(e)&&isNaN(t)?!1:e!==t}const l=new WeakMap;function R(e){if(M(e)||console.error("the value is a null"),_(e))return e;if(b(e))return l.get(e);const t=new Proxy(e,{set(n,r,s,f){let o=n[r];console.log("\u65B0\u65E7\u503C\u6BD4\u8F83\uFF1A",o,s);let i=Reflect.set(n,r,s,f);return E(s,o)&&d(n,r),i},get(n,r,s){if(r==="__isReactive")return!0;let f=Reflect.get(n,r,s);return h(n,r),f}});return l.set(e,t),t}function _(e){return!!e.__isReactive}function b(e){return l.has(e)}const g=window.obj=R({name:"coderlei"});w(()=>{console.log(g.name)});
